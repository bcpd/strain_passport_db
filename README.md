# Strain_Passport_DB

The repository contains scripts to generate an sqlite database and produce reports containing strain-associated information. For this version of the passport, we used species-level MAGs identified in a collection of microbial-based products and a mock community for the Phase 1 proof-of-concept.

## Preliminary steps
*1. MAG annotation*. To construct the database, MAGs need to be annotated with bakta and the predicted CDSs with DRAM.
*2. Merging of DRAM/bakta annotations tables.* Annotation tables are joined based on the GeneID, which is a combination of the MAG ID and the Locus tag (`merge_annotations.r`).
*3. Expert systems.* Per-MAG json files (generated by bakta) are parsed into virulence factors and AMR genes, which are then mapped to virulence categories and AMR classes (`get_expert_systems.r`).
*4. Patent and literature searches.* US patents and Pubmed records (2000-present) are searched and parsed for each species-level MAG (`patent_search.r` and `pubmed_v4.r`).
*5. BacDive API.* To access the BacDive database, a log-in profile is required. The database is searched and parsed with the R-based API for each species-level MAG (`get_bacdive_data.r`).

## Strain passport construction
-	`webScraperScraper.py`. Pulls data from the tables into StrainPassport.db
-	`createStrainPassports.R`. Creates the database connection in R and passes variables to the strain passport page template (RMD file). This script also obtains and parses KEGG xml files describing metabolic modules.
-	`StrainPassportTemplate.Rmd`. Strain passport page template. This is where db queries are called.
